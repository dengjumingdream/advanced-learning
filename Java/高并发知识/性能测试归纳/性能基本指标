<!--
 * @Author: MrDeng
 * @Date: 2022-08-09 12:13:30
 * @LastEditTime: 2022-08-09 17:42:18
 * @LastEditors: dengjuming
 * @Description: 
 * @FilePath: /advanced-learning/Java/高并发知识/性能测试归纳/性能基本指标
-->
一、基本分类
    1.业务指标
      - 并发用户数、TPS（系统每秒事务处理数）、成功率、响应时间
    2.资源指标
      - CPU资源利用率、内存利用率、I/O
    3.应用指标
      - 空闲线程数、数据库连接数、GC/Full GC次数、函数耗时等
    4.前端指标
      - 页面加载时间、网络时间（DNS，连接时间、传输时间）等。


二、业务指标
    1.响应时间
      - 事务响应时间：网络时间、服务器处理时间、网络延迟
      - 参考标准
        - 互联网企业：500 毫秒以下，例如淘宝业务 10 毫秒左右。
        - 金融企业：1 秒以下为佳，部分复杂业务 3 秒以下。
        - 保险企业：3 秒以下为佳。
        - 制造业：5 秒以下为佳。

    2.系统处理能力
      - 系统每秒钟能够处理的交易数量
      - 指标类型：
        - HPS：每秒点击率。
          - 最大HPS = 带宽 / 8 / 估算平均每个请求大小
          - 日访问量 = HPS * 3600 * 日访问小时数（可按8小时计算）
        - QPS：系统每秒处理查询次数，代表的是服务器的机器的性能最大吞吐能力。
        - TPS：系统每秒处理交易数
          - TPS = 脚本运行期间所有事务总数 / 脚本运行时长
          - 系统在同一时间内能够处理业务的最大能力
      - 参考标准：
        - 对于已上线系统：可选取高峰时刻，在一定时间内（如 3-10 分钟），获取系统总业务量，计算单位时间（秒）内完成的笔数，乘以 2-5 倍作为峰值的 TPS，例如峰值 3 分钟内处理订单 18 万笔，平均 TPS 是 1000，峰值 TPS 可以是 2000-5000。
        - 对于新系统：没有历史数据作参考，建议通过业务部门进行评估。根据经验，一般情况下：
          - 金融行业：1KTPS ~ 5WTPS，不包括互联网化的活动
          - 保险行业：100TPS ~ 10WTPS，不包括互联网化的活动
          - 制造行业：10TPS ~ 5KTPS
          - 互联网电子商务：1WTPS ~ 100WTPS
          - 互联网中型网站：1KTPS ~ 5WTPS
          - 互联网小型网站：500TPS ~ 1WTPS
          TPS 可以参照同行业系统和结合具体业务，中小企业 TPS 值为 50 ~ 1K 笔/秒，银行 TPS 值为 1K ~ 5W 笔/秒，淘宝 TPS 值为 3W~30W 笔/秒。

    3.吞吐量
      - 单位时间内系统处理的客户请求的数量，直接体现软件系统的性能承载能力。
      - 单位：请求数/秒、页面数/秒、人数/天 或 处理业务/时
      - 吞吐量：指单位时间内系统处理的请求数量，能直接反映服务器承受的压力，是需要重点关注的指标。
      - 吞吐率一般指用户在给定的一秒内从服务器获得的数据量，简而言之就是服务器返回的数据量。
      - QPS：每秒处理查询次数
      - 吞吐量范围比QPS更大。


    4.并发用户数
      - 系统用户数：该系统注册用户数
      - 在线用户数：登录系统的用户
      - 并发用户数：是对服务器产生压力的用户
      - 举例：
        例如一个邮件系统，有 100 个注册用户，那么系统用户数就是 100 个；其中一段时间内有 80 个用户登录使用，在这段时间内在线用户数就是 80。
        
        但其中有 10 个用户在阅读邮件内容，20 个用户在写邮件，这 30 个用户在此阶段对服务器并没有产生压力。只有产生了请求、提交等业务操作的用户才会对服务器构成压力。

        所以并发用户数是指在系统运行期间同一时刻进行业务操作的用户数量。一般应用系统并发用户数为在线用户数的 10%~20%，但还是要取决于具体的业务逻辑、业务场景。

    5.最大并发用户数
      - 最大并发用户数是指应用系统在正式环境下所能承受的最大并发用户数量。

三、资源指标
    1.处理器 CPU
      - CPU占用率：
        CPU利用率：
        - 如果该值持续超过 95%，则表明瓶颈是 CPU。可以考虑增加一个处理器或更换一个更快的处理器。一般可接受的最大上限是 80%~85%，合理使用的范围在 60%~70% 以下。
      - CPU上下文切换问题：
        - 自愿上下文切换，是指进程无法获取所需资源，导致的上下文切换。比如说， I/O、内存等系统资源不足时，就会发生自愿上下文切换。
        - 非自愿上下文切换，是指进程时间片已到等原因，系统强制调度，发生的切换。比如，大量进程都在争抢CPU，就容易发生非自愿上下文切换。
        - CPU调度算法
        - 调度器的配置参数

    2.内存 ARM Memory
      - 内存页交换速率
        - 问题归纳：线程竞争内存、内存访问命中率
        - 如果该值偶尔走高，则表明当时有线程竞争内存。
        - 如果该值持续很高，则内存可能是瓶颈，也可能是内存访问命中率低。
      - 可用字节数
        - 问题归纳：内存泄露
        - Memory/Available Bytes 计数器的值持续降低，同时 Process/Private Bytes 计数器和 Process/Working Set 计数器的值在长时间内持续升高，则很可能存在内存泄漏。

    3.磁盘 I/O
      - Disk Rate：磁盘交换率
        - 如果该数值一直很高，表明 I/O有问题

    4.带宽 
      - 一般使用计数器 Bytes Total/sec 来度量